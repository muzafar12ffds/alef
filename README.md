#  Hive Backorder bot
Скрипт для мониторинга тематичных освобождающихся ru и рф доменов. Что он делает:
1. Выгружает домены backorder.ru, которые освобождаются завтра и имеют минимум одного донора;
2. Фильтрует их, чтобы не было доменов в реестре РКН, судебных разбирательств и не в стоп-листе на передачу прав;
3. Составляет список доменов с вхождением ключей  в домен;
4. Список доменов с вхождением ключей в контент сайта. Контент берется из веб-архива;
5. Присылает эти списки сообщением в ТГ.

Ключевые слова для фильтрации доменов задаются с помощью регулярных выражений. Одна регулярка для поиска ключей в домене, вторая для поиска ключей. Это нужно, чтобы найти домн определенной тематики. Можно сгенерить регулярные выражения под тематику с помощью chatGPT. Я оставил в скрипте свои регулярки для мед тематики для примера.

Контент домена выгружается из archive.org по API. Это довольно ресурсозатратная операция в плане количества запросов, т.к. нужно отправлять запросы к API по каждому домену. Поэтому я ограничил количество доменов на 1000. Но домены отсортированы по количеству доноров, поэтому скрипт проверить первую тысячу с самым хорошим ссылочным. Скрипт загружает html из снапшота сайта и просто проверяет соответствие регулярному выражению. Т.е. нет никакой лемматизации или проверки, где находится ключ (в контенте или в ссылке или в title и т.д.). Но, по моему опыту, этого достаточно если правильно составить регулярное выражение.


## Подготовительные работы
- Вам необходимо создать Telegram бота. Вот ссылка на [инструкцию](https://habr.com/ru/articles/262247/) (только пункт 1. Регистрация);
- Прописать данные бота в [.env файл](https://w6p.ru/NjM4ZWM.png). TELEGRAM_API_TOKEN - токен, который вам выдал @BotFather. TELEGRAM_CHAT_ID - id чата, куда будет писать бот (можно узнать с помощью [бота](https://t.me/getmyid_bot));
- Добавить ваши регулярные выражения в [.env файл](https://w6p.ru/MGUzZDc.png). FILTER_REGEX_FOR_DOMAIN - регулярка для вхождения в домен. FILTER_REGEX_FOR_WAYBACK - регулярка для вхождения в контент сайта;

## Запуск и установка скрипта с Docker Compose
Нужен [Docker Compose](https://www.youtube.com/watch?v=a5mxBTGfC5k)
```
cd “папка скрипта”
docker-compose up
```
Если все ок ставим скрипт на cron 
```
crontab -e
```
И  прописываем строку
```
45 10 * * * cd “папка скрипта” && /usr/local/bin/docker-compose up
```

## Запуск и установка скрипта без Docker Compose
```
cd “папка скрипта”/app
npm install #устанавливаем зависимости. Делается 1 раз
node index.js

```
Если все ок ставим скрипт на cron 
```
crontab -e
```
И  прописываем строку
```
45 10 * * * node “папка скрипта”/app/index.js
```
## Про Cron
Подробнее про выполнение скриптов с помощью  cron можно почитать [тут](https://losst.pro/kak-dobavit-komandu-v-cron). Но если кратко, 45 10 в строке для крон означают 10 часов и 45 минут по времени вашего сервера. Так вы можете сами настроить удобное для вас время выполнения скрипта.